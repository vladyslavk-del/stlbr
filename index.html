<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Анимация полета */
        .fly-to-cart {
            position: fixed;
            z-index: 1000;
            transition: all 1s ease;
            border-radius: 50%;
            pointer-events: none; /* Чтобы не мешать кликам */
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div id="app" class="container mx-auto p-4 pb-28">
        <h1 class="text-3xl font-bold text-center mb-8">All Brainrot</h1>

        <div id="item-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
            <!-- Элементы будут вставлены сюда с помощью JavaScript -->
        </div>

    </div>

    <!-- Нижняя панель -->
    <div class="fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 p-4 flex justify-between items-center">
        <div class="text-lg">
            <span id="selected-count">0</span> Selected
        </div>
        <button id="continue-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed" disabled>
            Continue
        </button>
    </div>

    <!-- Модальное окно -->
    <div id="account-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-50">
        <div id="modal-content" class="bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-sm text-center">
            <!-- Шаг 1: Поиск аккаунта -->
            <div id="step-1">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Find Your Account</h2>
                    <button id="close-modal" class="text-gray-400 hover:text-white">&times;</button>
                </div>
                <p class="text-gray-400 mb-4">Enter your Roblox username.</p>
                <input id="username-input" type="text" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-3 mb-4 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Your Username">
                <button id="search-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300">Search</button>
            </div>

            <!-- Шаг 2: Подтверждение пользователя -->
            <div id="step-2" class="hidden">
                 <h2 class="text-2xl font-bold mb-4">User Found!</h2>
                 <p class="text-gray-400 mb-6">Username: <span id="found-username" class="font-bold text-white"></span></p>
                 <button id="claim-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-300">Claim For This User</button>
            </div>

            <!-- Шаг 3: Синхронизация -->
            <div id="step-3" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Syncing Items with Your Account...</h2>
                <div id="sync-items" class="flex justify-center gap-4 my-6">
                    <!-- Выбранные иконки будут здесь -->
                </div>
                <div class="w-full bg-gray-700 rounded-full h-4 mb-2">
                    <div id="progress-bar" class="bg-blue-600 h-4 rounded-full" style="width: 0%"></div>
                </div>
                 <p id="progress-text" class="text-gray-400 mb-4">Syncing... 0%</p>
                 <p class="text-sm text-gray-500">This is the final step. Do not refresh or close the page.</p>
            </div>
        </div>
    </div>
    
    <!-- Шаблон для Tailwind, чтобы он видел классы -->
    <div class="hidden">
         <div class="bg-gray-800 rounded-2xl p-4 text-center border-2 border-transparent hover:border-blue-500 transition duration-300 cursor-pointer"></div>
         <div class="border-yellow-400"></div>
         <button class="w-full mt-4 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">Select</button>
         <button class="w-full mt-4 bg-yellow-400 text-gray-900 py-2 rounded-lg font-semibold hover:bg-yellow-500 transition duration-300">Selected</button>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const items = [
                { name: 'Buhodefuego', img: 'https://i.postimg.cc/HsZbM50k/Buhodefuego.webp' },
                { name: 'Vampira capucinna', img: 'https://i.postimg.cc/W1Zt4JXY/Vampira-capucinna-image.webp' },
                { name: 'Zombie Tralala', img: 'https://i.postimg.cc/ncCG00hc/Zombie-Tralala-1.webp' },
                { name: 'Frankenmatteo', img: 'https://i.postimg.cc/sgCswH4K/Frankenmatteo.webp' },
                { name: 'La Vacca Jacko Linterino', img: 'https://i.postimg.cc/3xw5SMD4/Jacko-Vacca.webp' },
                { name: 'Spooky Grande', img: 'https://i.postimg.cc/WbHXvxHF/Spooky-Grande.webp' },
                { name: 'Noo My Examen', img: 'https://i.postimg.cc/2SNLhwbm/Noo-My-Examen.webp' },
                { name: 'LosPrimos', img: 'https://i.postimg.cc/8C06JVLs/Los-Primos.webp' },
                { name: 'My kids will also rob you', img: 'https://i.postimg.cc/XYvqwzN3/My-kids-will-also-rob-you.webp' },
                { name: 'Las Sis', img: 'https://i.postimg.cc/L5NR5m16/Las-Sis.webp' },
                { name: 'Los_shitheaditos', img: 'https://i.postimg.cc/RFSDFKQM/Los-shitheaditos.webp' },
                { name: 'Burguro-And-Fryuro', img: 'https://i.postimg.cc/pXwQ5yb0/Burguro-And-Fryuro.webp' },
                { name: 'Meowl', img: 'https://i.postimg.cc/qv7tRTgc/Clear-background-clear-meowl-image.webp' },
                { name: 'Garama and Madundung', img: 'https://i.postimg.cc/zvtr295G/Garamadundung.webp' },
                { name: 'Strawberryelephant', img: 'https://i.postimg.cc/zGTQV9MG/Strawberryelephant.webp' },
            ];

            const itemGrid = document.getElementById('item-grid');
            const selectedCountEl = document.getElementById('selected-count');
            const continueBtn = document.getElementById('continue-btn');
            
            let selectedItems = new Set();

            function renderItems() {
                itemGrid.innerHTML = ''; // Очищаем сетку перед рендером
                items.forEach((item, index) => {
                    const isSelected = selectedItems.has(item.name);

                    const card = document.createElement('div');
                    card.className = `item-card bg-gray-800 rounded-2xl p-4 text-center border-2 hover:border-blue-500 transition duration-300 cursor-pointer ${isSelected ? 'border-yellow-400' : 'border-transparent'}`;
                    card.dataset.id = item.name;

                    const img = document.createElement('img');
                    img.src = item.img;
                    img.alt = item.name;
                    img.className = 'mx-auto h-24 w-24 object-contain mb-4';
                    
                    const name = document.createElement('h3');
                    name.className = 'font-semibold truncate';
                    name.textContent = item.name;
                    
                    const button = document.createElement('button');
                    button.className = `w-full mt-4 py-2 rounded-lg font-semibold transition duration-300 ${isSelected ? 'bg-yellow-400 text-gray-900 hover:bg-yellow-500' : 'bg-blue-600 text-white hover:bg-blue-700'}`;
                    button.textContent = isSelected ? 'Selected' : 'Select';
                    
                    button.onclick = (e) => {
                        e.stopPropagation(); // Предотвращаем срабатывание клика по карточке
                        toggleSelection(item, card, button);
                    };

                    card.onclick = () => {
                         toggleSelection(item, card, button);
                    };

                    card.appendChild(img);
                    card.appendChild(name);
                    card.appendChild(button);
                    itemGrid.appendChild(card);
                });
            }
            
            function toggleSelection(item, cardElement, buttonElement) {
                const itemImage = cardElement.querySelector('img');
                const isSelected = selectedItems.has(item.name);

                if (isSelected) {
                    selectedItems.delete(item.name);
                } else {
                    // Анимация
                    const rect = itemImage.getBoundingClientRect();
                    const flyingImage = itemImage.cloneNode(true);
                    flyingImage.classList.add('fly-to-cart');
                    document.body.appendChild(flyingImage);

                    const selectedCounterRect = selectedCountEl.getBoundingClientRect();

                    flyingImage.style.left = `${rect.left}px`;
                    flyingImage.style.top = `${rect.top}px`;
                    flyingImage.style.width = `${rect.width}px`;
                    flyingImage.style.height = `${rect.height}px`;

                    // Запускаем анимацию
                    requestAnimationFrame(() => {
                        flyingImage.style.left = `${selectedCounterRect.left + (selectedCounterRect.width / 2)}px`;
                        flyingImage.style.top = `${selectedCounterRect.top + (selectedCounterRect.height / 2)}px`;
                        flyingImage.style.width = '0px';
                        flyingImage.style.height = '0px';
                        flyingImage.style.opacity = '0';
                    });
                    
                    setTimeout(() => {
                        flyingImage.remove();
                    }, 1000); // Удаляем клон после анимации

                    selectedItems.add(item.name);
                }
                
                updateSelectionState(cardElement, buttonElement, !isSelected);
                updateContinueButton();
            }

            function updateSelectionState(card, button, isSelected) {
                if (isSelected) {
                    card.classList.add('border-yellow-400');
                    card.classList.remove('border-transparent');
                    button.classList.remove('bg-blue-600', 'text-white', 'hover:bg-blue-700');
                    button.classList.add('bg-yellow-400', 'text-gray-900', 'hover:bg-yellow-500');
                    button.textContent = 'Selected';
                } else {
                    card.classList.remove('border-yellow-400');
                    card.classList.add('border-transparent');
                    button.classList.remove('bg-yellow-400', 'text-gray-900', 'hover:bg-yellow-500');
                    button.classList.add('bg-blue-600', 'text-white', 'hover:bg-blue-700');
                    button.textContent = 'Select';
                }
            }

            function updateContinueButton() {
                const count = selectedItems.size;
                selectedCountEl.textContent = count;
                continueBtn.disabled = count === 0;
            }

            // --- Логика модального окна ---
            const modal = document.getElementById('account-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const searchBtn = document.getElementById('search-btn');
            const claimBtn = document.getElementById('claim-btn');
            const usernameInput = document.getElementById('username-input');
            const foundUsername = document.getElementById('found-username');

            const step1 = document.getElementById('step-1');
            const step2 = document.getElementById('step-2');
            const step3 = document.getElementById('step-3');

            continueBtn.addEventListener('click', () => modal.classList.remove('hidden'));
            closeModalBtn.addEventListener('click', () => modal.classList.add('hidden'));

            searchBtn.addEventListener('click', () => {
                const username = usernameInput.value.trim();
                if (username) {
                    foundUsername.textContent = username;
                    step1.classList.add('hidden');
                    step2.classList.remove('hidden');
                }
            });

            claimBtn.addEventListener('click', () => {
                step2.classList.add('hidden');
                step3.classList.remove('hidden');
                startSync();
            });

            function startSync() {
                const syncItemsContainer = document.getElementById('sync-items');
                syncItemsContainer.innerHTML = '';
                const itemsToSync = items.filter(item => selectedItems.has(item.name));
                
                itemsToSync.slice(0, 3).forEach(item => {
                    const img = document.createElement('img');
                    img.src = item.img;
                    img.className = 'h-12 w-12 object-contain bg-gray-700 p-1 rounded-md';
                    syncItemsContainer.appendChild(img);
                });

                const progressBar = document.getElementById('progress-bar');
                const progressText = document.getElementById('progress-text');
                let width = 0;
                const interval = setInterval(() => {
                    if (width >= 100) {
                        clearInterval(interval);
                        progressText.textContent = 'Sync Complete!';
                        // Можно добавить здесь логику закрытия модального окна
                    } else {
                        width++;
                        progressBar.style.width = width + '%';
                        progressText.textContent = `Syncing... ${width}%`;
                    }
                }, 50);
            }
            
            // Инициализация
            renderItems();
            updateContinueButton();
        });
    </script>
</body>
</html>

